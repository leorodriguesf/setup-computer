#!/usr/bin/env bash

# Exit on error, unset variables, and pipe failure
set -euo pipefail

# Trigger op authentication
op --version >/dev/null

ansible-vault encrypt <(op item list --format=json | op item get - --reveal) --vault-password-file=<(
    op item get "1Password" --fields label=password --reveal | jq -r '.'
) --output "~/personal/passwords.vault"
